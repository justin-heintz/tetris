!function(t){var n,e,i,o,u=1e3/60,r=0,f=0,s=60,a=.9,c=1e3,m=0,d=0,l=0,p=0,h=!1,w=!1,F=!1,M="object"==typeof window?window:t,g=M.requestAnimationFrame||(o=Date.now(),function(t){return e=Date.now(),i=Math.max(0,u-(e-o)),o=e+i,setTimeout(function(){t(e+i)},i)}),x=M.cancelAnimationFrame||clearTimeout,S=function(){},b=S,y=S,A=S,D=S;function T(t){if(n=g(T),!(t<f+p)){for(r+=t-f,f=t,b(t,r),t>m+c&&(s=a*d*1e3/(t-m)+(1-a)*s,m=t,d=0),d++,l=0;r>=u;)if(y(u),r-=u,++l>=240){F=!0;break}A(r/u),D(s,F),F=!1}}t.MainLoop={getSimulationTimestep:function(){return u},setSimulationTimestep:function(t){return u=t,this},getFPS:function(){return s},getMaxAllowedFPS:function(){return 1e3/p},setMaxAllowedFPS:function(t){return void 0===t&&(t=1/0),0===t?this.stop():p=1e3/t,this},resetFrameDelta:function(){var t=r;return r=0,t},setBegin:function(t){return b=t||b,this},setUpdate:function(t){return y=t||y,this},setDraw:function(t){return A=t||A,this},setEnd:function(t){return D=t||D,this},start:function(){return w||(w=!0,n=g(function(t){A(1),h=!0,f=t,m=t,d=0,n=g(T)})),this},stop:function(){return h=!1,w=!1,x(n),this},isRunning:function(){return h}},"function"==typeof define&&define.amd?define(t.MainLoop):"object"==typeof module&&null!==module&&"object"==typeof module.exports&&(module.exports=t.MainLoop)}(this);